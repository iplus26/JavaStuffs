# 使用文档

1. 文件夹内 RunnableMidiPlayer.jar 是可运行文件
2. 支持键盘事件，小写状态下的
		
		q w e r a s d f g h j k l ; 
	分别对应 14 白键，可以发出 
	
		F4 G4 A4 B4 C5 D5 E5 F5 G5 A5 B5 C6 D6 E6
	的音，而小写状态下的 
		
		t y u i o p [
	分别对应 7 个黑键，可以发出
	
		C# D# E# F# G# A# B#
	的音。按下时，对应琴键会变色；松开时，对应琴键会恢复原来的颜色。
3. 支持鼠标事件，可以用鼠标点击。点击效果同键盘事件。
4. 打开之后会卡两秒钟，我也不知道为什么。


# 心路历程

我觉得这个实验没有之前的那个复杂。

在一开始我就想好了新建一个 MidiKey 的类，白键和黑键都是这个类，这个类是继承标签的。我一开始就想好了用标签，然后结合 KeyEvent 和 MouseEvent 事件，标签设为黑色和白色两种颜色，然后先排一行白色标签，然后再排一行黑色标签。我听说我室友一开始用的是按钮，但是按钮有一个麻烦，就是按钮会互相覆盖，比如说白键本来在黑键下面，按了之后白键会弹到黑键上面来，这个是符合逻辑的。后来我看到他在画不规则形状的白键，我就省去了这个麻烦。

一开始我在 Midi 里面新建 Player 的实例，然后作为参数传给线程（我也不知道我为什么这么做），会随机出现某个按键按不响的现象，并且报 `java.lang.IllegalStateException: sequencer not open` 的错误，到网上搜了没什么结果，现在还是不知道为什么。后来我在线程里面新建 Player  的实例就不会有问题。

今天收尾的时候写鼠标事件，本来想着和键盘事件一样，只要 addKeyListener，然后跟键盘事件不同的是，鼠标事件应该是判断按在哪个部件上面。但是其实有些不一样，

* 鼠标事件是要每个键添加的，然后用到了 MouseAdapter 这个东西。代码如下


		keys[i].addMouseListener(new MouseAdapter() {
			public void mousePressed(MouseEvent me) {
				// when mouse is pressed
			}
		}

* 另外一个不同之处就是 keyTyped 和 keyPressed, keyReleased 是重复计算的，当我按下一个键的时候，这个键的三个方法都会生效。但是 mouseClicked 和 mousePressed, mouseReleased 是不重复的，只会计算 mouseClicked 事件，而另外两个事件就不会生效。

之前的一个实验，因为很久没有写 Java 了，所以比较生疏；而这次实验，我自认为用了一些面向对象的思想，当然还有很多可以改进的地方，不过这些做法给我带来了很大的便利。


因为头两天就做完了，然后拖延症一直耗了两个礼拜才来写实验报告和心路历程，所以不记得遇到什么难题了。其实感觉从头到尾都是很顺畅的，这个实验对我来说最难的就是——从小到大我都是三好学生——如果我的体育和音乐能及格的话，勉强能够在文档中看懂 half、quarter 是什么，至于什么C4、D5的都是问室友才知道的，所以如果老师发现我的键盘布局太奇葩，就忍忍吧…